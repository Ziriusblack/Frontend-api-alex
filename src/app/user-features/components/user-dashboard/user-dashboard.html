<navigation-bar></navigation-bar>

<div class="min-h-screen bg-gray-50 px-4 sm:px-6 lg:px-8 py-8">

  <!-- Search Header -->
  <div class="mb-6">
    <h2 class="text-2xl font-bold text-gray-900">Buscar Quejas</h2>
  </div>

  <!-- Search Form -->
  <div class="bg-white shadow rounded-lg p-6 mb-6">
    <form [formGroup]="searchForm" (ngSubmit)="searchComplaints()" class="grid grid-cols-1 sm:grid-cols-3 gap-4 items-end">
      
      <!-- Busqueda -->
      <div class="flex flex-col">
        <label for="searchTerm" class="text-sm font-medium text-gray-700 mb-1">Búsqueda</label>
        <input 
          id="searchTerm"
          type="text"
          formControlName="searchTerm"
          placeholder="Asunto o radicado..."
          class="px-3 py-2 border rounded-lg text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"
        />
      </div>

      <!-- Estado -->
      <div class="flex flex-col">
        <label for="status" class="text-sm font-medium text-gray-700 mb-1">Estado</label>
        <select 
          id="status" 
          formControlName="status"
          class="px-3 py-2 border rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"
        >
          <option value="">Todos</option>
          @for (item of statusOptions; track item.value) {
            <option [value]=item.value>{{ item.label }}</option>
          }
        </select>
      </div>

      <!-- Botón Buscar -->
      <div class="flex justify-start sm:justify-end">
        <button type="submit" class="bg-orange-500 text-white px-4 py-2 rounded-lg shadow hover:bg-orange-600 transition-colors">
          Buscar
        </button>
      </div>

    </form>
  </div>

  <!-- Loading Indicator -->
  @if (loading) {
    <div class="text-center py-4 bg-white shadow rounded-lg mb-6">
      <p class="text-gray-500">Cargando quejas...</p>
    </div>
  }

  <!-- Error Message -->
  @if (error) {
    <div class="text-center py-4 bg-red-50 text-red-700 shadow rounded-lg mb-6">
      <p>{{ error }}</p>
    </div>
  }

  <!-- Results Table -->
  @if (!loading && !error) {
    <div class="bg-white shadow-md rounded-lg p-6">
  <h3 class="text-lg font-bold text-black mb-4">Resultados</h3>

  @if (complaints.length > 0) {
    <div class="overflow-x-auto">
      <table class="min-w-full border border-gray-200 rounded-lg">
        <!-- Encabezado -->
        <thead class="bg-orange-500">
          <tr>
            <th class="px-4 py-3 text-left text-sm font-semibold text-white">Radicado</th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-white">Asunto</th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-white">Estado</th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-white">Fecha de creación</th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-white">Acciones</th>
          </tr>
        </thead>
        
        <!-- Cuerpo -->
        <tbody class="divide-y divide-gray-200">
          @for (complaint of complaints; track $index) {
            <tr class="hover:bg-orange-50 transition">
              <td class="px-4 py-2 text-black font-medium">{{ complaint.reference }}</td>
              <td class="px-4 py-2 text-gray-800">{{ complaint.subject }}</td>
              <td class="px-4 py-2">
                <span class="px-2 py-1 text-xs font-semibold rounded-full
                  {{ complaint.status === 'Resuelto' ? 'bg-green-100 text-green-700' :
                     complaint.status === 'En proceso' ? 'bg-yellow-100 text-yellow-700' :
                     'bg-red-100 text-red-700' }}">
                  {{ complaint.status }}
                </span>
              </td>
              <td class="px-4 py-2 text-gray-600">{{ complaint.recievedDate }}</td>
              <td class="px-4 py-2">
                <button 
                  (click)="viewComplaint(complaint.id)" 
                  class="bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded-md text-sm font-medium transition">
                  Ver
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
  @else {
    <p class="text-gray-500 text-sm italic mt-4">No se encontraron resultados.</p>
  }
</div>

      }

      <!-- No Results -->
      @if(complaints.length === 0) {
        <p class="text-gray-500 mt-4">No se encontraron quejas que coincidan con la búsqueda.</p>
      }

      <!-- Pagination -->
<div class="flex items-center justify-center border-t border-white/10 px-4 py-3 sm:px-6">
  <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-center">
    <div>
      <p class="text-sm text-gray-300 mb-2 text-center">
        Showing
        <span class="font-medium">1</span>
        to
        <span class="font-medium">10</span>
        of
        <span class="font-medium">97</span>
        results
      </p>
    </div>
    <div>
      <nav aria-label="Pagination" class="isolate inline-flex -space-x-px rounded-md">
        <a href="#" class="relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 inset-ring inset-ring-gray-700 hover:bg-white/5 focus:z-20 focus:outline-offset-0">
          <span class="sr-only">Previous</span>
          <svg viewBox="0 0 20 20" fill="currentColor" class="size-5">
            <path d="M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z" />
          </svg>
        </a>
        
        <a href="#" aria-current="page" class="relative z-10 inline-flex items-center bg-orange-500 px-4 py-2 text-sm font-semibold text-white focus:z-20">1</a>
        <a href="#" class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-200 inset-ring inset-ring-gray-700 hover:bg-orange-400 focus:z-20">2</a>
        <a href="#" class="relative hidden items-center px-4 py-2 text-sm font-semibold text-gray-200 inset-ring inset-ring-gray-700 hover:bg-orange-400 focus:z-20 md:inline-flex">3</a>
        <span class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-400 inset-ring inset-ring-gray-700">...</span>
        <a href="#" class="relative hidden items-center px-4 py-2 text-sm font-semibold text-gray-200 inset-ring inset-ring-gray-700 hover:bg-orange-400 focus:z-20 md:inline-flex">8</a>
        <a href="#" class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-200 inset-ring inset-ring-gray-700 hover:bg-orange-400 focus:z-20">9</a>
        <a href="#" class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-200 inset-ring inset-ring-gray-700 hover:bg-orange-400 focus:z-20">10</a>
        
        <a href="#" class="relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 inset-ring inset-ring-gray-700 hover:bg-white/5 focus:z-20">
          <span class="sr-only">Next</span>
          <svg viewBox="0 0 20 20" fill="currentColor" class="size-5">
            <path d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z" />
          </svg>
        </a>
      </nav>
    </div>
  </div>
</div>
